(window.webpackJsonp=window.webpackJsonp||[]).push([[31,33],{940:function(e,t,a){"use strict";a.r(t);var r=a(928),n=a(939),o=a(899),l=a(901),i=a(62),s=a(20),c=a(38),u=a(12),m=a(90),d=a(16),p=a(82),f=a(21),h=a(133),y=a(47),g=a(1),b=a.n(g),v=a(68),S=a.n(v),E=a(929),w=a.n(E),x=a(935),k=a(936),D=a(25),C=a(937),P=a.n(C),_=a(938),O,R;function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function I(e){return A(e)||N(e)||j(e)||T()}function T(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function j(e,t){if(e){if("string"==typeof e)return L(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?L(e,t):void 0}}function N(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function A(e){if(Array.isArray(e))return L(e)}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V(e,t,a){return t&&M(e.prototype,t),a&&M(e,a),e}function z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q(e,t)}function Q(e,t){return(Q=Object.setPrototypeOf||function e(t,a){return t.__proto__=a,t})(e,t)}function W(e){var t=J();return function a(){var r=K(e),n;if(t){var o=K(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return B(this,n)}}function B(e,t){return!t||"object"!==q(t)&&"function"!=typeof t?H(e):t}function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var $=y.a.Row,G=y.a.Col,U=Object(D.withRouter)(O=R=function(e){z(a,e);var t=W(a);function a(){var e;F(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={id:"".concat(e.props.match.params.clusterName,"|").concat(e.props.match.params.ksqlServerId),consoleValue:"",runStatus:!0,stopStatus:!0,queryPropertiesStatus:!1,queryProperties:new Map,queryPropertiesShow:[],queryPropertiesShowMap:new Map,results:[],schema:[],jsonView:null,mounted:!0},e.ws=new WebSocket(window.location.host.indexOf("3333")>0?"ws://127.0.0.1:8080/ksql_console":"http:"===window.location.protocol?"ws://".concat(window.location.host,"/ksql_console"):"wss://".concat(window.location.host,"/ksql_console")),e.customAceEditorCompleter={getCompletions:function e(t,a,r,n,o){var l;o(null,[].concat(I(["create","create stream","create stream as select","create table","create table as select","drop stream","drop table","as","select","left","full","inner","join","window","windowstart","where","rowkey","group","by","having","and","emit","changes","type","stream","with","drop","table","show","types","insert","into","values","describe","extended","function","explain","if","exists","delete","topic","print","from","beginning","interval","limit","rowtime","set","cast","kafka_topic","case","when","then","else","end","like","between","list","functions","topics","streams","tables","queries","properties","spool","terminate","struct","abs","arraycontains","as_array","as_map","ceil","concat","unix_date","unix_timestamp","datetostring","elt","entries","extractjsonfield","exp","field","floor","generate_series","generate_series","geo_distance","ifnull","initcap","lcase","len","ln","mask","mask_keep_left","mask_keep_right","mask_left","mask_right","random","replace","round","sign","sqrt","slice","split","stringtodate","stringtotimestamp","substring","timestamptostring","trim","ucase","url_decode_param","url_encode_param","url_extract_fragment","url_extract_host","url_extract_parameter","url_extract_path","url_extract_port","url_extract_protocol","url_extract_query","collect_list","collect_set","count","histogram","average","max","min","sum","topk","topkdistinct","windowstart","windowend","explode","value_format","partition","partitions","replicas","value_delimiter","key","timestamp","timestamp_format","wrap_single_value","window_type","window_size","kafka_ceter is best."].map((function(e){return{caption:e,value:e,meta:"static"}}))),I(a.$mode.$highlightRules.$keywordList.map((function(e){return{caption:e,value:e,meta:"keyword"}})))))}},e.onChange=function(t){e.setState({consoleValue:t})},e.onRun=function(){var t=e.state.consoleValue;if(null==t||0===t.trim().length)f.a.error("can not be empty!");else{e.setState({results:[],jsonView:null});var a="ksql",r;t.toLowerCase().startsWith("select")&&(a="query");var n=e.state.queryProperties,o={};n.forEach((function(e){null!=e.n&&e.n.trim().length>0&&null!=e.v&&e.v.trim().length>0&&(o[e.n]=e.v)})),t.endsWith(";")||(t+=";");var l={id:e.state.id,message:JSON.stringify({ksql:t,streamsProperties:o}),operate:"run",type:a};e.ws.send(JSON.stringify(l)),e.setState({runStatus:!0,stopStatus:!1})}},e.onStop=function(){var t={id:e.state.id,message:"",operate:"stop"};e.ws.send(JSON.stringify(t)),e.setState({runStatus:!1,stopStatus:!0})},e.onAddQueryProperties=function(){if(0===e.state.queryPropertiesShow.length){var t=b.a.createElement("div",{key:0},b.a.createElement($,null,"\xa0"),b.a.createElement($,null,b.a.createElement(G,null," ",b.a.createElement(d.a,{defaultValue:"auto.offset.reset",onChange:e.onPropertiesChange,name:"0n"}),"\xa0=\xa0",b.a.createElement(d.a,{defaultValue:"latest",onChange:e.onPropertiesChange,name:"0v"}),"\xa0\xa0 ",b.a.createElement(s.a,{primary:"true",text:!0,onClick:function t(){return e.onRemoveProperties(0)}},b.a.createElement(u.a,{type:"ashbin"})," ")))),a=new Map;a.set(0,t);var r=e.state.queryProperties;r.set("0",{n:"auto.offset.reset",v:"latest"}),e.setState({queryPropertiesStatus:!e.state.queryPropertiesStatus,queryPropertiesShow:[t],queryPropertiesShowMap:a,queryProperties:r})}else e.setState({queryPropertiesStatus:!e.state.queryPropertiesStatus})},e.onRemoveProperties=function(t){t=t?Number(t.index):0;var a=e.state.queryPropertiesShowMap,r=e.state.queryProperties;r.delete("".concat(t)),a.delete(t);var n=[];a.forEach((function(e){n.push(e)})),0===a.size&&e.setState({queryPropertiesStatus:!e.state.queryPropertiesStatus}),e.setState({queryPropertiesShow:n,queryPropertiesShowMap:a,queryProperties:r})},e.onPropertiesChange=function(t,a){var r=a.currentTarget.name,n=r.substring(0,1),o=r.substring(1,2),l=e.state.queryProperties,i=l.get(n)?l.get(n):{};i[o]=t,l.set(n,i),e.setState({queryProperties:l})},e.onAddAnotherProperties=function(){var t=e.state.queryPropertiesShow.length,a=b.a.createElement("div",{key:t},b.a.createElement($,null,"\xa0"),b.a.createElement($,null,b.a.createElement(G,null," ",b.a.createElement(d.a,{onChange:e.onPropertiesChange,name:"".concat(t,"n")}),"\xa0=\xa0",b.a.createElement(d.a,{onChange:e.onPropertiesChange,name:"".concat(t,"v")}),"\xa0\xa0 ",b.a.createElement(s.a,{primary:"true",text:!0,onClick:function a(){return e.onRemoveProperties({index:t})}},b.a.createElement(u.a,{type:"ashbin"})," ")))),r=e.state.queryPropertiesShowMap;r.set(t,a),e.setState({queryPropertiesShow:[].concat(I(e.state.queryPropertiesShow),[a]),queryPropertiesShowMap:r})},e}return V(a,[{key:"componentDidMount",value:function e(){var t=this;this.ws.onopen=function(){t.setState({runStatus:!1,stopStatus:!0})},this.ws.onclose=function(){t.state.mounted&&t.setState({runStatus:!0,stopStatus:!0})},this.ws.onmessage=function(e){if(t.state.mounted)try{var a=t.state.consoleValue.toLowerCase(),r=JSON.parse(e.data);if(a.startsWith("select")||r.errorMessage)if(0===t.state.schema.length){for(var n,o=r.header.schema.split(","),l=[],i=0;i<o.length;i+=1){var s=o[i].substring(o[i].indexOf("`")+1,o[i].lastIndexOf("`"));l=[].concat(I(l),[s])}t.setState({schema:l})}else try{for(var c=r.row.columns,u=t.state.schema,m={},d=0;d<u.length;d+=1)m[u[d]]=c[d];var p=[m].concat(I(t.state.results));t.setState({results:p})}catch(a){var f=b.a.createElement(P.a,{id:"json-pretty",data:e.data,keyStyle:"color:#008080;font-size:1.5em",valueStyle:"color:#0f1e78;font-size:1.5em"});t.setState({jsonView:f}),console.warn(a)}else{var h=b.a.createElement(P.a,{id:"json-pretty",data:e.data,keyStyle:"color:#008080;font-size:1.5em",valueStyle:"color:#0f1e78;font-size:1.5em"});t.setState({jsonView:h,runStatus:!1,stopStatus:!0})}}catch(a){var y=b.a.createElement(P.a,{id:"json-pretty",data:e.data,keyStyle:"color:#008080;font-size:1.5em",valueStyle:"color:#0f1e78;font-size:1.5em"});t.setState({jsonView:y,runStatus:!1,stopStatus:!0}),t.onStop(),console.error(a)}}}},{key:"componentWillUnmount",value:function e(){var t={id:this.state.id,message:"",operate:"stop"};this.setState({mounted:!1}),this.ws.send(JSON.stringify(t))}},{key:"render",value:function e(){var t=this.state,a=t.results,r=t.jsonView,o=b.a.createElement("div",{style:X.messageStyle},b.a.createElement("h1",null,"No new messages"),"The message browser shows messages that have arrived since this page was opened.");return b.a.createElement(S.a,null,b.a.createElement(l.a,{className:"free-card custom",free:!0},b.a.createElement("div",{className:"free-card-main"},b.a.createElement(l.a.Content,null,b.a.createElement($,null,b.a.createElement(G,{span:"24"},b.a.createElement(w.a,{placeholder:"Example: SELECT field1, field2, field3 FROM mystream WHERE field1 = \u2018somevalue\u2019 EMIT CHANGES;",mode:"sql",height:"100px",value:this.state.consoleValue,width:"100%",theme:"xcode",name:"blah2",onChange:this.onChange,fontSize:14,showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,setOptions:{enableBasicAutocompletion:[this.customAceEditorCompleter],enableLiveAutocompletion:!0,showLineNumbers:!1,tabSize:2}})))),b.a.createElement(l.a.Actions,null,b.a.createElement(n.a,{dashed:!0}),b.a.createElement($,null,b.a.createElement(G,{span:"12"},b.a.createElement($,null,b.a.createElement(s.a,{text:!0,onClick:this.onAddQueryProperties,style:{display:"block",color:"blue",textAlign:"left",textDecoration:"underline"}},"Add query properties")),b.a.createElement("div",{style:{display:this.state.queryPropertiesStatus?"":"none"}},this.state.queryPropertiesShow.map((function(e){return e})),b.a.createElement($,null,"\xa0"),b.a.createElement($,null,b.a.createElement(s.a,{text:!0,onClick:this.onAddAnotherProperties,style:{display:"block",color:"blue",textAlign:"left",textDecoration:"underline"}},"Add another field")))),b.a.createElement(G,{span:"12"},b.a.createElement("span",{style:{display:this.state.runStatus?"":"none"}},"Running...\xa0\xa0"),b.a.createElement("span",null,b.a.createElement(s.a,{type:"primary",disabled:this.state.runStatus,onClick:this.onRun},"\xa0\xa0 Run\xa0\xa0")," \xa0\xa0",b.a.createElement(s.a,{type:"secondary",disabled:this.state.stopStatus,onClick:this.onStop},"\xa0\xa0Stop\xa0\xa0"))))))),b.a.createElement(l.a,{style:X.resultStyle,className:"free-card custom",free:!0},b.a.createElement("div",{className:"free-card-main"},b.a.createElement(l.a.Content,null,r||a.length>0?null:o,a.map((function(e){return b.a.createElement("p",{key:e.ROWTIME},JSON.stringify(e))})),r))))}}]),a}(g.Component))||O,X={resultStyle:{marginTop:"50px",minHeight:"200px"},messageStyle:{textAlign:"center"}},Y=t.default=U},968:function(e,t,a){"use strict";a.r(t);var r=a(910),n=a(911),o=a(1),l=a.n(o),i=a(68),s=a.n(i),c=a(158),u=a(940),m=a(199),d=a(22),p=a(62),f=a(20),h=a(90),y=a(16),g=a(82),b=a(21),v=a(157),S=a(83),E=a(133),w=a(47),x=a(270),k=a(25),D=a(24),C,P;function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function q(e,t,a){return t&&R(e.prototype,t),a&&R(e,a),e}function I(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}function T(e,t){return(T=Object.setPrototypeOf||function e(t,a){return t.__proto__=a,t})(e,t)}function j(e){var t=L();return function a(){var r=F(e),n;if(t){var o=F(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return N(this,n)}}function N(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?A(e):t}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var M=w.a.Row,V=w.a.Col,z=Object(k.withRouter)(C=P=function(e){I(a,e);var t=j(a);function a(){var e;O(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={ksqlServerId:e.props.match.params.ksqlServerId,clusterName:e.props.match.params.clusterName,isLoading:!1,filterDataSource:[],dataSource:[],pageData:[],visible:!1,detailRecord:{}},e.renderOper=function(t,a,r){return l.a.createElement("div",null,l.a.createElement("a",{style:Q.link,onClick:function t(){return e.handelDetail(r)}},"Describe"),l.a.createElement("span",{style:Q.separator}),l.a.createElement("a",{style:Q.link,onClick:function t(){return e.handleDelete(r)}},"Drop"))},e.handelDetail=function(t){e.setState({visible:!e.state.visible,detailRecord:t})},e.hideDetailDialog=function(){e.setState({visible:!1})},e.handleDelete=function(t){S.a.confirm({content:"Do you want to Drop  ".concat(t.name,"?"),onOk:function a(){e.handleDeletes(t)},okProps:{children:"OK"},cancelProps:{children:"Cancel"}})},e.handleDeletes=function(t){var a=e.state.ksqlServerId,r=e.state.clusterName;e.setState({isLoading:!0},(function(){D.a.delete("/ksql/drop_stream?ksqlServerId=".concat(a,"&clusterName=").concat(r,"&streamName=").concat(t.name)).then((function(t){200===t.data.code?(e.getStreams(a,r),b.a.success(t.data.message||"drop streams success")):b.a.error(t.data.message||"drop streams has error"),e.setState({isLoading:!1})})).catch((function(e){console.error(e)}))}))},e.redrawPageData=function(t){e.setState({pageData:t})},e.refreshTableData=function(t){e.setState({filterDataSource:t})},e.handleFilterChange=function(t){var a=e.state.dataSource,r=[];0===t.trim().length?r=a:a.forEach((function(e){e.name.toLocaleLowerCase().includes(t.toLocaleLowerCase())&&r.push(e)})),e.setState({searchValue:t}),e.refreshTableData(r)},e.getStreams=function(t,a){e.setState({isLoading:!0},(function(){D.a.post("/ksql/show_streams?ksqlServerId=".concat(t,"&clusterName=").concat(a)).then((function(t){if(200===t.data.code){var a=t.data.data;e.setState({dataSource:a,filterDataSource:a,isLoading:!1})}else b.a.error(t.data.message),e.setState({isLoading:!1})})).catch((function(e){console.error(e)}))}))},e}return q(a,[{key:"componentDidMount",value:function e(){this.getStreams(this.state.ksqlServerId,this.state.clusterName)}},{key:"render",value:function e(){return l.a.createElement("div",null,l.a.createElement(M,{style:Q.row},l.a.createElement(V,{align:"center"},l.a.createElement("span",{style:{fontWeight:"600"}},"Stream Name:\xa0\xa0\xa0"),l.a.createElement(y.a,{placeholder:"StreamName",hasClear:!0,onChange:this.handleFilterChange,style:{width:"200px"},value:this.state.searchValue}))),l.a.createElement(S.a,{className:"simple-form-dialog",style:Q.simpleFormDialog,autoFocus:!1,footerAlign:"center",footer:l.a.createElement(f.a,{type:"primary",onClick:this.hideDetailDialog},"Cancel"),onClose:this.hideDetailDialog,cancelProps:{children:"Cancel"},isFullScreen:!0,visible:this.state.visible},l.a.createElement("div",null,l.a.createElement(s.a,{title:"Describe Stream "},l.a.createElement("ul",null,l.a.createElement("li",{style:Q.detailItem},l.a.createElement("div",{style:Q.detailTitle},"Stream:"),l.a.createElement("div",null,this.state.detailRecord.name)),l.a.createElement("li",{style:Q.detailItem},l.a.createElement("div",{style:Q.detailTitle},"TopicName:"),l.a.createElement("div",null,this.state.detailRecord.topic)),l.a.createElement("li",{style:Q.detailItem},l.a.createElement("div",{style:Q.detailTitle},"Format:"),l.a.createElement("div",null,this.state.detailRecord.format)),l.a.createElement("li",{style:Q.detailItem},l.a.createElement("div",{style:Q.detailTitle},"Partitions:"),l.a.createElement("div",null,this.state.detailRecord.partitions)),l.a.createElement("li",{style:Q.detailItem},l.a.createElement("div",{style:Q.detailTitle},"Replication:"),l.a.createElement("div",null,this.state.detailRecord.replication)),l.a.createElement("li",{style:Q.detailItem},l.a.createElement("div",{style:Q.detailTitle},"Schema:")),l.a.createElement("li",null,l.a.createElement(d.a,{size:"small",dataSource:this.state.detailRecord.fields},l.a.createElement(d.a.Column,{title:"Name",dataIndex:"name"}),l.a.createElement(d.a.Column,{title:"Type",dataIndex:"schema.type"}))))))),l.a.createElement(d.a,{loading:this.state.isLoading,dataSource:this.state.pageData,hasBorder:!1},l.a.createElement(d.a.Column,{title:"Stream",dataIndex:"name"}),l.a.createElement(d.a.Column,{title:"Topic Name",dataIndex:"topic"}),l.a.createElement(d.a.Column,{title:"Data Format",dataIndex:"format"}),l.a.createElement(d.a.Column,{title:"Operation",cell:this.renderOper})),l.a.createElement(x.a,{dataSource:this.state.filterDataSource,redrawPageData:this.redrawPageData}))}}]),a}(o.Component))||C,Q={link:{margin:"0 5px",color:"rgba(49, 128, 253, 0.65)",cursor:"pointer",textDecoration:"none"},loading:{width:"100%"},separator:{margin:"0 8px",display:"inline-block",height:"12px",width:"1px",verticalAlign:"middle",background:"#e8e8e8"},row:{margin:"20px 4px 20px"},operBtn:{display:"inline-block",width:"24px",height:"24px",borderRadius:"999px",color:"#929292",background:"#f2f2f2",textAlign:"center",cursor:"pointer",lineHeight:"24px",marginRight:"6px"},detailItem:{padding:"15px 0px",display:"flex",borderTop:"1px solid #EEEFF3"},detailTitle:{marginRight:"30px",textAlign:"left",width:"50px",color:"#999999"},simpleFormDialog:{width:"640px"}},W=z,B,H;function J(e){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function G(e,t,a){return t&&$(e.prototype,t),a&&$(e,a),e}function U(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}function X(e,t){return(X=Object.setPrototypeOf||function e(t,a){return t.__proto__=a,t})(e,t)}function Y(e){var t=te();return function a(){var r=ae(e),n;if(t){var o=ae(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Z(this,n)}}function Z(e,t){return!t||"object"!==J(t)&&"function"!=typeof t?ee(e):t}function ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function te(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function ae(e){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var re=w.a.Row,ne=w.a.Col,oe=Object(k.withRouter)(B=H=function(e){U(a,e);var t=Y(a);function a(){var e;K(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={ksqlServerId:e.props.match.params.ksqlServerId,clusterName:e.props.match.params.clusterName,isLoading:!1,filterDataSource:[],dataSource:[],pageData:[],visible:!1,detailRecord:{}},e.renderOper=function(t,a,r){return l.a.createElement("div",null,l.a.createElement("a",{style:le.link,onClick:function t(){return e.handelDetail(r)}},"Describe"),l.a.createElement("span",{style:le.separator}),l.a.createElement("a",{style:le.link,onClick:function t(){return e.handleDelete(r)}},"Drop"))},e.handelDetail=function(t){e.setState({visible:!e.state.visible,detailRecord:t})},e.hideDetailDialog=function(){e.setState({visible:!1})},e.handleDelete=function(t){S.a.confirm({content:"Do you want to Drop  ".concat(t.name,"?"),onOk:function a(){e.handleDeletes(t)},okProps:{children:"OK"},cancelProps:{children:"Cancel"}})},e.handleDeletes=function(t){var a=e.state.ksqlServerId,r=e.state.clusterName;e.setState({isLoading:!0},(function(){D.a.delete("/ksql/drop_table?ksqlServerId=".concat(a,"&clusterName=").concat(r,"&tableName=").concat(t.name)).then((function(t){200===t.data.code?(e.getTables(a,r),b.a.success(t.data.message||"drop table success")):b.a.error(t.data.message||"drop table has error"),e.setState({isLoading:!1})})).catch((function(e){console.error(e)}))}))},e.redrawPageData=function(t){e.setState({pageData:t})},e.refreshTableData=function(t){e.setState({filterDataSource:t})},e.handleFilterChange=function(t){var a=e.state.dataSource,r=[];0===t.trim().length?r=a:a.forEach((function(e){e.name.toLocaleLowerCase().includes(t.toLocaleLowerCase())&&r.push(e)})),e.setState({searchValue:t}),e.refreshTableData(r)},e.getTables=function(t,a){e.setState({isLoading:!0},(function(){D.a.post("/ksql/show_tables?ksqlServerId=".concat(t,"&clusterName=").concat(a)).then((function(t){if(200===t.data.code){var a=t.data.data;e.setState({dataSource:a,filterDataSource:a,isLoading:!1})}else b.a.error(t.data.message),e.setState({isLoading:!1})})).catch((function(e){console.error(e)}))}))},e}return G(a,[{key:"componentDidMount",value:function e(){this.getTables(this.state.ksqlServerId,this.state.clusterName)}},{key:"render",value:function e(){return l.a.createElement("div",null,l.a.createElement(re,{style:le.row},l.a.createElement(ne,{align:"center"},l.a.createElement("span",{style:{fontWeight:"600"}},"Table Name:\xa0\xa0\xa0"),l.a.createElement(y.a,{placeholder:"TableName",hasClear:!0,onChange:this.handleFilterChange,style:{width:"200px"},value:this.state.searchValue}))),l.a.createElement(S.a,{className:"simple-form-dialog",style:le.simpleFormDialog,autoFocus:!1,footerAlign:"center",footer:l.a.createElement(f.a,{type:"primary",onClick:this.hideDetailDialog},"Cancel"),onClose:this.hideDetailDialog,cancelProps:{children:"Cancel"},isFullScreen:!0,visible:this.state.visible},l.a.createElement("div",null,l.a.createElement(s.a,{title:"Describe Table "},l.a.createElement("ul",null,l.a.createElement("li",{style:le.detailItem},l.a.createElement("div",{style:le.detailTitle},"Table:"),l.a.createElement("div",null,this.state.detailRecord.name)),l.a.createElement("li",{style:le.detailItem},l.a.createElement("div",{style:le.detailTitle},"TopicName:"),l.a.createElement("div",null,this.state.detailRecord.topic)),l.a.createElement("li",{style:le.detailItem},l.a.createElement("div",{style:le.detailTitle},"Format:"),l.a.createElement("div",null,this.state.detailRecord.format)),l.a.createElement("li",{style:le.detailItem},l.a.createElement("div",{style:le.detailTitle},"Partitions:"),l.a.createElement("div",null,this.state.detailRecord.partitions)),l.a.createElement("li",{style:le.detailItem},l.a.createElement("div",{style:le.detailTitle},"Replication:"),l.a.createElement("div",null,this.state.detailRecord.replication)),l.a.createElement("li",{style:le.detailItem},l.a.createElement("div",{style:le.detailTitle},"Schema:")),l.a.createElement("li",null,l.a.createElement(d.a,{size:"small",dataSource:this.state.detailRecord.fields},l.a.createElement(d.a.Column,{title:"Name",dataIndex:"name"}),l.a.createElement(d.a.Column,{title:"Type",dataIndex:"schema.type"}))))))),l.a.createElement(d.a,{loading:this.state.isLoading,dataSource:this.state.pageData,hasBorder:!1},l.a.createElement(d.a.Column,{title:"Table",dataIndex:"name"}),l.a.createElement(d.a.Column,{title:"Topic Name",dataIndex:"topic"}),l.a.createElement(d.a.Column,{title:"Data Format",dataIndex:"format"}),l.a.createElement(d.a.Column,{title:"Operation",cell:this.renderOper})),l.a.createElement(x.a,{dataSource:this.state.filterDataSource,redrawPageData:this.redrawPageData}))}}]),a}(o.Component))||B,le={link:{margin:"0 5px",color:"rgba(49, 128, 253, 0.65)",cursor:"pointer",textDecoration:"none"},loading:{width:"100%"},separator:{margin:"0 8px",display:"inline-block",height:"12px",width:"1px",verticalAlign:"middle",background:"#e8e8e8"},row:{margin:"20px 4px 20px"},operBtn:{display:"inline-block",width:"24px",height:"24px",borderRadius:"999px",color:"#929292",background:"#f2f2f2",textAlign:"center",cursor:"pointer",lineHeight:"24px",marginRight:"6px"},detailItem:{padding:"15px 0px",display:"flex",borderTop:"1px solid #EEEFF3"},detailTitle:{marginRight:"30px",textAlign:"left",width:"50px",color:"#999999"},simpleFormDialog:{width:"640px"}},ie=oe,se,ce;function ue(e){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function de(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pe(e,t,a){return t&&de(e.prototype,t),a&&de(e,a),e}function fe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}function he(e,t){return(he=Object.setPrototypeOf||function e(t,a){return t.__proto__=a,t})(e,t)}function ye(e){var t=ve();return function a(){var r=Se(e),n;if(t){var o=Se(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ge(this,n)}}function ge(e,t){return!t||"object"!==ue(t)&&"function"!=typeof t?be(e):t}function be(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ve(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Se(e){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var Ee=w.a.Row,we=w.a.Col,xe=Object(k.withRouter)(se=ce=function(e){fe(a,e);var t=ye(a);function a(){var e;me(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={ksqlServerId:e.props.match.params.ksqlServerId,clusterName:e.props.match.params.clusterName,isLoading:!1,filterDataSource:[],dataSource:[],pageData:[],visible:!1,detailRecord:{}},e.renderOper=function(t,a,r){return l.a.createElement("div",null,l.a.createElement("a",{style:ke.link,onClick:function t(){return e.handelDetail(r)}},"Explain"),l.a.createElement("span",{style:ke.separator}),l.a.createElement("a",{style:ke.link,onClick:function t(){return e.handleDelete(r)}},"Terminate"))},e.handelDetail=function(t){e.setState({visible:!e.state.visible,detailRecord:t})},e.hideDetailDialog=function(){e.setState({visible:!1})},e.handleDelete=function(t){S.a.confirm({content:"Do you want to Terminate  ".concat(t.id,"?"),onOk:function a(){e.handleDeletes(t)},okProps:{children:"OK"},cancelProps:{children:"Cancel"}})},e.handleDeletes=function(t){var a=e.state.ksqlServerId,r=e.state.clusterName;e.setState({isLoading:!0},(function(){D.a.delete("/ksql/terminate_query?ksqlServerId=".concat(a,"&clusterName=").concat(r,"&queryId=").concat(t.id)).then((function(t){200===t.data.code?(e.getQueries(a,r),b.a.success(t.data.message||"Terminate query success")):b.a.error(t.data.message||"Terminate query has error"),e.setState({isLoading:!1})})).catch((function(e){console.error(e)}))}))},e.redrawPageData=function(t){e.setState({pageData:t})},e.refreshTableData=function(t){e.setState({filterDataSource:t})},e.handleFilterChange=function(t){var a=e.state.dataSource,r=[];0===t.trim().length?r=a:a.forEach((function(e){e.id.toLocaleLowerCase().includes(t.toLocaleLowerCase())&&r.push(e)})),e.setState({searchValue:t}),e.refreshTableData(r)},e.getQueries=function(t,a){e.setState({isLoading:!0},(function(){D.a.post("/ksql/show_queries?ksqlServerId=".concat(t,"&clusterName=").concat(a)).then((function(t){if(200===t.data.code){var a=t.data.data;e.setState({dataSource:a,filterDataSource:a,isLoading:!1})}else b.a.error(t.data.message),e.setState({isLoading:!1})})).catch((function(e){console.error(e)}))}))},e}return pe(a,[{key:"componentDidMount",value:function e(){this.getQueries(this.state.ksqlServerId,this.state.clusterName)}},{key:"render",value:function e(){return l.a.createElement("div",null,l.a.createElement(Ee,{style:ke.row},l.a.createElement(we,{align:"center"},l.a.createElement("span",{style:{fontWeight:"600"}},"Query ID:\xa0\xa0\xa0"),l.a.createElement(y.a,{placeholder:"Query ID",hasClear:!0,onChange:this.handleFilterChange,style:{width:"200px"},value:this.state.searchValue}))),l.a.createElement(S.a,{className:"simple-form-dialog",style:ke.simpleFormDialog,autoFocus:!1,footerAlign:"center",footer:l.a.createElement(f.a,{type:"primary",onClick:this.hideDetailDialog},"Cancel"),onClose:this.hideDetailDialog,isFullScreen:!0,visible:this.state.visible},l.a.createElement("div",null,l.a.createElement(s.a,{title:"Explain Queries "},l.a.createElement("ul",null,l.a.createElement("li",{style:ke.detailItem},l.a.createElement("div",{style:ke.detailTitle},"QueryID:"),l.a.createElement("div",null,this.state.detailRecord.id)),l.a.createElement("li",{style:ke.detailItem},l.a.createElement("div",{style:ke.detailTitle},"Source:"),l.a.createElement("div",null,this.state.detailRecord.source)),l.a.createElement("li",{style:ke.detailItem},l.a.createElement("div",{style:ke.detailTitle},"Sink:"),l.a.createElement("div",null,this.state.detailRecord.sinks)),l.a.createElement("li",{style:ke.detailItem},l.a.createElement("div",{style:ke.detailTitle},"State:"),l.a.createElement("div",null,this.state.detailRecord.state)),l.a.createElement("li",{style:ke.detailItem},l.a.createElement("div",{style:ke.detailTitle},"SqlText:"),l.a.createElement("div",null,this.state.detailRecord.queryString)),l.a.createElement("li",{style:ke.detailItem},l.a.createElement("div",{style:ke.detailTitle},"Schema:")),l.a.createElement("li",null,l.a.createElement(d.a,{size:"small",dataSource:this.state.detailRecord.fields},l.a.createElement(d.a.Column,{title:"Name",dataIndex:"name"}),l.a.createElement(d.a.Column,{title:"Type",dataIndex:"schema.type"}))))))),l.a.createElement(d.a,{loading:this.state.isLoading,dataSource:this.state.pageData,hasBorder:!1},l.a.createElement(d.a.Column,{title:"Query ID",dataIndex:"id"}),l.a.createElement(d.a.Column,{title:"Source",dataIndex:"source"}),l.a.createElement(d.a.Column,{title:"Sink",dataIndex:"sinks"}),l.a.createElement(d.a.Column,{title:"Operation",cell:this.renderOper})),l.a.createElement(x.a,{dataSource:this.state.filterDataSource,redrawPageData:this.redrawPageData}))}}]),a}(o.Component))||se,ke={simpleFormDialog:{width:"640px"},link:{margin:"0 5px",color:"rgba(49, 128, 253, 0.65)",cursor:"pointer",textDecoration:"none"},loading:{width:"100%"},separator:{margin:"0 8px",display:"inline-block",height:"12px",width:"1px",verticalAlign:"middle",background:"#e8e8e8"},row:{margin:"20px 4px 20px"},operBtn:{display:"inline-block",width:"24px",height:"24px",borderRadius:"999px",color:"#929292",background:"#f2f2f2",textAlign:"center",cursor:"pointer",lineHeight:"24px",marginRight:"6px"},detailItem:{padding:"15px 0px",display:"flex",borderTop:"1px solid #EEEFF3"},detailTitle:{marginRight:"30px",textAlign:"left",width:"42px",color:"#999999"},detailBody:{textAlign:"left"}},De=xe;function Ce(e){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Oe(e,t,a){return t&&_e(e.prototype,t),a&&_e(e,a),e}function Re(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qe(e,t)}function qe(e,t){return(qe=Object.setPrototypeOf||function e(t,a){return t.__proto__=a,t})(e,t)}function Ie(e){var t=Ne();return function a(){var r=Ae(e),n;if(t){var o=Ae(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Te(this,n)}}function Te(e,t){return!t||"object"!==Ce(t)&&"function"!=typeof t?je(e):t}function je(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ne(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Ae(e){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var Le=function(e){Re(a,e);var t=Ie(a);function a(){var e;Pe(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={streams:l.a.createElement(W,null),tables:l.a.createElement(ie,null),queries:l.a.createElement(De,null)},e.onTabChanged=function(t){var a="/ksql/".concat(e.props.match.params.clusterName,"/").concat(e.props.match.params.ksqlServerId,"/").concat(t);e.props.history.push(a);var r=(new Date).getTime();"streams"===t?e.setState({streams:l.a.createElement(W,{key:r})}):"tables"===t?e.setState({tables:l.a.createElement(ie,{key:r})}):"queries"===t&&e.setState({queries:l.a.createElement(De,{key:r})})},e}return Oe(a,[{key:"render",value:function e(){var t=[{link:"",text:"KSQL"},{link:"#/ksql/list",text:"List"}];return l.a.createElement("div",null,l.a.createElement(c.a,{items:t,title:"KSQL Home"}),l.a.createElement(s.a,{style:Fe.container},l.a.createElement(n.a,{onChange:this.onTabChanged,defaultActiveKey:this.props.match.params.tab},l.a.createElement(n.a.Item,{title:"Console",key:"console"},l.a.createElement(u.default,null)," "),l.a.createElement(n.a.Item,{title:"Streams",key:"streams"},this.state.streams),l.a.createElement(n.a.Item,{title:"Tables",key:"tables"},this.state.tables," "),l.a.createElement(n.a.Item,{title:"Queries",key:"queries"},this.state.queries," "))))}}]),a}(o.Component),Fe={container:{margin:"20px",padding:"10px 20px 20px",minHeight:"600px"}},Me=t.default=Le}}]);